<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="pl"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TeamService.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">MPR2</a> &gt; <a href="index.source.html" class="el_package">service</a> &gt; <span class="el_source">TeamService.java</span></div><h1>TeamService.java</h1><pre class="source lang-java linenums">package service;

import model.Employee;
import model.Position;
import model.ProjectTeam;

// Serwis operacyjny odpowiedzialny za zarządzanie strukturą zespołów projektowych.
// Obsługuje procesy przydzielania pracowników (onboarding), transferów międzyzespołowych
// oraz weryfikację zgodności struktury zespołu z regułami biznesowymi.
<span class="nc" id="L10">public class TeamService {</span>

    /**
     * Przypisuje pracownika do wskazanego zespołu projektowego.
     * Metoda przeprowadza walidację dostępności pracownika (czy nie posiada już przypisania)
     * oraz pojemności zespołu docelowego (czy nie przekroczono limitu członków).
     *
     * @param employee Pracownik, który ma zostać przypisany.
     * @param team Zespół docelowy.
     * @throws IllegalStateException W przypadku, gdy pracownik jest już członkiem innego zespołu lub gdy zespół docelowy jest pełny.
     */
    public void assignEmployeeToTeam(Employee employee, ProjectTeam team) {
        // Weryfikacja czy pracownik jest &quot;wolnym zasobem&quot;.
<span class="nc bnc" id="L23" title="All 2 branches missed.">        if (employee.getCurrentTeam() != null) {</span>
<span class="nc" id="L24">            throw new IllegalStateException(&quot;Pracownik jest już w innym zespole (&quot;</span>
<span class="nc" id="L25">                    + employee.getCurrentTeam().getTeamName() + &quot;)&quot;);</span>
        }

        // Weryfikacja limitu miejsc w zespole (Capacity Check).
<span class="nc bnc" id="L29" title="All 2 branches missed.">        if (team.getMembers().size() &gt;= team.getMaxTeamSize()) {</span>
<span class="nc" id="L30">            throw new IllegalStateException(&quot;Zespół jest już pełny (Max: &quot;</span>
<span class="nc" id="L31">                    + team.getMaxTeamSize() + &quot;)&quot;);</span>
        }

<span class="nc" id="L34">        forceAssign(employee, team);</span>
<span class="nc" id="L35">    }</span>

    /**
     * Realizuje procedurę transferu pracownika z obecnego zespołu do nowego.
     * Operacja jest atomowa z punktu widzenia logiki biznesowej: najpierw sprawdza dostępność miejsca w nowym zespole,
     * następnie usuwa powiązanie ze starym i tworzy nowe.
     *
     * @param employee Pracownik podlegający transferowi.
     * @param newTeam Zespół docelowy.
     * @throws IllegalStateException Jeśli nowy zespół nie posiada wolnych miejsc.
     */
    public void transferEmployee(Employee employee, ProjectTeam newTeam) {
        // Sprawdzenie pojemności przed wykonaniem jakichkolwiek zmian (Fail-fast).
<span class="nc bnc" id="L48" title="All 2 branches missed.">        if (newTeam.getMembers().size() &gt;= newTeam.getMaxTeamSize()) {</span>
<span class="nc" id="L49">            throw new IllegalStateException(&quot;Nowy zespół jest już pełny (Max: &quot;</span>
<span class="nc" id="L50">                    + newTeam.getMaxTeamSize() + &quot;)&quot;);</span>
        }

        // Jeśli pracownik posiada aktualne przypisanie, należy je najpierw rozwiązać.
<span class="nc bnc" id="L54" title="All 2 branches missed.">        if (employee.getCurrentTeam() != null) {</span>
<span class="nc" id="L55">            forceRemove(employee, employee.getCurrentTeam());</span>
        }

        // Ustanowienie nowej relacji.
<span class="nc" id="L59">        forceAssign(employee, newTeam);</span>
<span class="nc" id="L60">    }</span>

    // Metoda pomocnicza usuwająca dwukierunkową relację między pracownikiem a zespołem.
    // Aktualizuje stan obiektu Team (usunięcie z listy) oraz Employee (ustawienie referencji na null).
    private void forceRemove(Employee employee, ProjectTeam team) {
<span class="nc" id="L65">        team.removeMember(employee);</span>
<span class="nc" id="L66">        employee.leaveCurrentTeam();</span>
<span class="nc" id="L67">    }</span>

    // Metoda pomocnicza ustanawiająca dwukierunkową relację między pracownikiem a zespołem.
    // Aktualizuje stan obiektu Employee (ustawienie referencji zespołu) oraz Team (dodanie do listy członków).
    private void forceAssign(Employee employee, ProjectTeam team) {
<span class="nc" id="L72">        employee.setCurrentTeam(team);</span>
<span class="nc" id="L73">        team.addMember(employee);</span>
<span class="nc" id="L74">    }</span>

    /**
     * Weryfikuje, czy zespół spełnia wymogi strukturalne (Compliance).
     * W obecnej implementacji sprawdza, czy w składzie zespołu znajduje się przynajmniej jedna osoba
     * na stanowisku kierowniczym (MANAGER).
     *
     * @param team Zespół poddawany weryfikacji.
     * @return true, jeśli zespół posiada Managera; false w przeciwnym razie.
     */
    public boolean isTeamDiversityCompliant(ProjectTeam team) {
<span class="nc bnc" id="L85" title="All 2 branches missed.">        for (Employee member : team.getMembers()) {</span>
<span class="nc bnc" id="L86" title="All 2 branches missed.">            if (member.getPosition() == Position.MANAGER) {</span>
<span class="nc" id="L87">                return true;</span>
            }
<span class="nc" id="L89">        }</span>
<span class="nc" id="L90">        return false;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>